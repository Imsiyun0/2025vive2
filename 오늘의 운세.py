import streamlit as st
from datetime import datetime
import random
import hashlib

st.set_page_config(page_title="오늘의 운세", page_icon="🔮", layout="centered")

st.title("🔮 오늘의 운세를 확인해보세요!")
st.write("당신의 생일과 오늘의 기운으로 운세를 알려드릴게요.")

# 생년월일 입력
birth_date = st.date_input("🎂 생년월일을 입력하세요", min_value=datetime(1900, 1, 1), max_value=datetime.today())

# 운세 종류 선택
selected_types = st.multiselect(
    "🔍 알고 싶은 운세 종류를 선택하세요:",
    ["💰 금전운", "❤️ 애정운", "💪 건강운", "📚 오늘의 조언"],
    default=["💰 금전운", "❤️ 애정운", "💪 건강운", "📚 오늘의 조언"]
)

# 운세 데이터
fortunes = {
    "💰 금전운": [
        "오늘은 당신의 지갑에 예상치 못한 기쁨이 찾아올 수 있는 날입니다. 주변에서 뜻밖의 선물을 받거나, 잊고 있었던 돈이 들어올 가능성도 있습니다. 다만, 충동구매의 유혹이 강하게 다가오니 신중한 소비가 필요합니다.",
        "금전적인 부분에서는 평온한 흐름이 유지되겠지만, 무언가 큰 결정을 하기에는 아직 때가 아닙니다. 지출 계획을 다시 점검하고, 소소한 절약 습관을 들이기에 좋은 하루입니다.",
        "투자에 관심이 있다면 오늘은 작은 시도에 좋은 결과가 따를 수 있습니다. 단, 너무 무리한 도전은 피하고, 이미 알고 있는 분야에서 움직이는 것이 유리합니다. 재정적인 안정감을 느낄 수 있는 하루가 될 거예요."
    ],
    "❤️ 애정운": [
        "사랑과 감정의 물결이 풍부한 하루입니다. 솔로라면 우연한 만남에서 설렘이 시작될 수 있고, 연인과 함께라면 특별한 시간을 보내기에 딱 좋은 날입니다. 진심을 담은 말 한마디가 큰 울림을 줄 거예요.",
        "감정이 예민해지기 쉬운 날이니 말과 행동에 신중을 기하세요. 상대방의 작은 말에 상처받기 쉬우므로, 오해가 생겼다면 빨리 풀어내는 것이 중요합니다.",
        "당신의 매력이 빛나는 하루입니다. 평소보다 자신감을 갖고 행동해보세요. 썸이나 연애 중이라면 진전을 기대해도 좋고, 연인이 있다면 서로에 대한 애정이 한층 더 깊어지는 계기가 될 수 있습니다."
    ],
    "💪 건강운": [
        "에너지가 가득한 하루입니다! 평소보다 기분도 상쾌하고 활력이 넘치니, 운동을 시작하거나 건강한 루틴을 실천하기에 딱 좋은 날입니다.",
        "피로가 쌓였거나 스트레스가 누적되었다면, 오늘은 반드시 자신을 위한 휴식을 챙기세요. 마음의 여유가 몸의 건강으로 이어집니다.",
        "건강이 다소 예민해질 수 있는 하루입니다. 과로와 과식은 피하고, 식습관과 수면 패턴을 다시 돌아보세요. 간단한 스트레칭이나 따뜻한 차 한잔이 도움이 됩니다."
    ],
    "📚 오늘의 조언": [
        "새로운 시도를 두려워하지 마세요. 당신 안에 있는 가능성을 스스로도 놀랄 만큼 발견하게 될 수 있습니다. 오늘은 도전이 행운으로 이어지는 날입니다.",
        "작은 친절이 큰 행운으로 돌아올 수 있습니다. 주변 사람들과의 관계에서 따뜻한 말 한마디가 큰 힘이 됩니다. 긍정적인 에너지를 나누면 그만큼 좋은 기운이 돌아올 거예요.",
        "마음이 흔들릴 때는 잠시 멈춰서 자신을 돌아보세요. 조급함보다는 천천히 가는 것이 더 나은 결과를 가져올 수 있습니다. 오늘 하루는 '여유'라는 단어를 기억하세요."
    ]
}

if st.button("✨ 운세 보기"):
    if not selected_types:
        st.warning("운세 종류를 하나 선택해주세요!")
    else:
        today = datetime.today().strftime("%Y-%m-%d")
        combined = str(birth_date) + today
        seed = int(hashlib.sha256(combined.encode()).hexdigest(), 16) % (10 ** 8)
        random.seed(seed)

        st.subheader("🌟 선택한 오늘의 운세 🌟")
        for category in selected_types:
            message = random.choice(fortunes[category])
            st.markdown(f"**{category}**\n\n{message}\n")

        st.success("오늘도 좋은 하루 되세요! 🍀")
