import streamlit as st
import random

# ìš´ì„¸ ì¢…ë¥˜
fortune_types = ["ì—°ì• ìš´", "ê¸ˆì „ìš´", "ì§ì—…ìš´"]

# íƒ€ë¡œ ì¹´ë“œ ë°ì´í„°
tarot_cards = [
    {
        "name": "The Fool",
        "image": "https://upload.wikimedia.org/wikipedia/en/9/90/RWS_Tarot_00_Fool.jpg",
        "meanings": {
            "ì—°ì• ìš´": "ìƒˆë¡œìš´ ì¸ì—°ì´ ë‹¤ê°€ì˜¤ê±°ë‚˜, ì§€ê¸ˆ ê´€ê³„ì—ì„œ ììœ ë¡œì›€ì´ í•„ìš”í•  ìˆ˜ ìˆì–´ìš”.",
            "ê¸ˆì „ìš´": "ì¶©ë™ì ì¸ ì†Œë¹„ì— ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. ë¬´ê³„íší•œ íˆ¬ìëŠ” í”¼í•˜ì„¸ìš”.",
            "ì§ì—…ìš´": "ìƒˆë¡œìš´ ê¸°íšŒê°€ ì˜¬ ìˆ˜ ìˆì§€ë§Œ, ì¤€ë¹„ê°€ ì•ˆ ë˜ë©´ ë„ì „ì´ ìœ„í—˜í•  ìˆ˜ ìˆì–´ìš”."
        }
    },
    {
        "name": "The Magician",
        "image": "https://upload.wikimedia.org/wikipedia/en/d/de/RWS_Tarot_01_Magician.jpg",
        "meanings": {
            "ì—°ì• ìš´": "ë‹¹ì‹ ì˜ ë§¤ë ¥ì´ ë¹›ë‚˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. í‘œí˜„í•˜ë©´ ì¢‹ì€ ê²°ê³¼ê°€ ìˆì„ ê±°ì˜ˆìš”.",
            "ê¸ˆì „ìš´": "ëŠ¥ë ¥ì„ ì˜ í™œìš©í•˜ë©´ ì¢‹ì€ ìˆ˜ìµ ê¸°íšŒê°€ ìˆì–´ìš”.",
            "ì§ì—…ìš´": "ëŠ¥ë ¥ì„ ì¸ì •ë°›ê³  ì„±ê³¼ë¥¼ ë‚¼ ìˆ˜ ìˆëŠ” ì‹œê¸°ì…ë‹ˆë‹¤."
        }
    },
    {
        "name": "The Lovers",
        "image": "https://upload.wikimedia.org/wikipedia/en/d/db/RWS_Tarot_06_Lovers.jpg",
        "meanings": {
            "ì—°ì• ìš´": "ì¤‘ìš”í•œ ì„ íƒì˜ ê¸°ë¡œì— ì„œ ìˆìŠµë‹ˆë‹¤. ë§ˆìŒì˜ ì†Œë¦¬ì— ê·€ ê¸°ìš¸ì´ì„¸ìš”.",
            "ê¸ˆì „ìš´": "ì§€ì¶œì— ìˆì–´ ê°€ì¡±ì´ë‚˜ ì—°ì¸ê³¼ì˜ ì¡°ìœ¨ì´ í•„ìš”í•  ìˆ˜ ìˆì–´ìš”.",
            "ì§ì—…ìš´": "ë™ë£Œ ë˜ëŠ” íŒŒíŠ¸ë„ˆì™€ì˜ í˜‘ë ¥ì´ ì¤‘ìš”í•©ë‹ˆë‹¤."
        }
    },
    {
        "name": "The Tower",
        "image": "https://upload.wikimedia.org/wikipedia/en/5/53/RWS_Tarot_16_Tower.jpg",
        "meanings": {
            "ì—°ì• ìš´": "ì˜ˆìƒì¹˜ ëª»í•œ ê°ˆë“±ì´ë‚˜ ì´ë³„ì˜ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤. ì‹ ì¤‘í•˜ê²Œ ëŒ€ì²˜í•˜ì„¸ìš”.",
            "ê¸ˆì „ìš´": "ì˜ˆê¸°ì¹˜ ëª»í•œ ì§€ì¶œì— ëŒ€ë¹„í•˜ì„¸ìš”. í° íˆ¬ìì—ëŠ” ìœ„í—˜ì´ ë”°ë¦…ë‹ˆë‹¤.",
            "ì§ì—…ìš´": "ë³€í™”ê°€ ê°•ì œë  ìˆ˜ ìˆëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. ë§ˆìŒì˜ ì¤€ë¹„ë¥¼ í•˜ì„¸ìš”."
        }
    },
    {
        "name": "The Star",
        "image": "https://upload.wikimedia.org/wikipedia/en/d/db/RWS_Tarot_17_Star.jpg",
        "meanings": {
            "ì—°ì• ìš´": "í¬ë§ì ì¸ ë³€í™”ê°€ ê¸°ëŒ€ë©ë‹ˆë‹¤. ê¸ì •ì ì¸ ìì„¸ë¥¼ ìœ ì§€í•˜ì„¸ìš”.",
            "ê¸ˆì „ìš´": "ì„œì„œíˆ ì¬ì •ì´ íšŒë³µë˜ë©° ë¹›ì„ ë³´ê¸° ì‹œì‘í•  ìˆ˜ ìˆì–´ìš”.",
            "ì§ì—…ìš´": "ê¸´ ì‹œê°„ ë…¸ë ¥í•´ì˜¨ ê²°ê³¼ê°€ ê³§ ë³´ì¼ ìˆ˜ ìˆì–´ìš”."
        }
    },
]

# ì¢…í•© í•´ì„ í…œí”Œë¦¿
def generate_summary(fortune_type, selected_cards):
    keywords = [card["name"] for card in selected_cards]
    meanings = [card["meanings"][fortune_type] for card in selected_cards]

    summary = ""

    if fortune_type == "ì—°ì• ìš´":
        summary += "ğŸ’– **ì—°ì• ìš´ ì¢…í•© í•´ì„**\n\n"
        summary += "ì´ë²ˆ ë¦¬ë”©ì€ ë‹¤ìŒê³¼ ê°™ì€ íë¦„ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:\n\n"
        summary += f"- ê°ì •ì˜ íë¦„: {meanings[0]}\n"
        summary += f"- ê´€ê³„ì˜ ì „í™˜ì : {meanings[1]}\n"
        summary += f"- ì¡°ì–¸ ë˜ëŠ” ê²°ê³¼: {meanings[2]}\n\n"
        summary += "ì´í‰: ê°ì •ì— ì†”ì§í•˜ë˜ ì„£ë¶€ë¥¸ íŒë‹¨ì€ í”¼í•˜ì„¸ìš”. ë§ˆìŒì„ ì²œì²œíˆ í‘œí˜„í•˜ë©´ ì¢‹ì€ íë¦„ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤."

    elif fortune_type == "ê¸ˆì „ìš´":
        summary += "ğŸ’° **ê¸ˆì „ìš´ ì¢…í•© í•´ì„**\n\n"
        summary += "ë‹¹ì‹ ì˜ ê¸ˆì „ íë¦„ì€ ë‹¤ìŒê³¼ ê°™ì€ ë°©í–¥ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:\n\n"
        summary += f"- í˜„ì¬ ì¬ì • ìƒíƒœ: {meanings[0]}\n"
        summary += f"- ìœ„í—˜ ìš”ì†Œ ë˜ëŠ” ê¸°íšŒ: {meanings[1]}\n"
        summary += f"- í–¥í›„ ì¡°ì–¸: {meanings[2]}\n\n"
        summary += "ì´í‰: ê°ì— ì˜ì¡´í•˜ê¸°ë³´ë‹¨ êµ¬ì²´ì ì¸ ê³„íšê³¼ í˜„ì‹¤ì ì¸ íŒë‹¨ì´ í•„ìš”í•œ ì‹œê¸°ì…ë‹ˆë‹¤."

    elif fortune_type == "ì§ì—…ìš´":
        summary += "ğŸ’¼ **ì§ì—…ìš´ ì¢…í•© í•´ì„**\n\n"
        summary += "ì§ì—…ê³¼ ê´€ë ¨ëœ íë¦„ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n"
        summary += f"- í˜„ì¬ ì§ì¥ ìƒí™© ë˜ëŠ” íƒœë„: {meanings[0]}\n"
        summary += f"- ë„ì „ í˜¹ì€ ë³€í™” ìš”ì¸: {meanings[1]}\n"
        summary += f"- ê²°ê³¼ ë˜ëŠ” ì¡°ì–¸: {meanings[2]}\n\n"
        summary += "ì´í‰: ë³€í™”ì˜ íë¦„ ì†ì—ì„œë„ ì¤‘ì‹¬ì„ ì¡ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ë‚´ë©´ì˜ ì§ê°ì„ ë¯¿ìœ¼ì„¸ìš”."

    return summary

# UI ì‹œì‘
st.title("ğŸ”® íƒ€ë¡œ ì¹´ë“œ ìš´ì„¸ ë¦¬ë”©")
st.write("ìš´ì„¸ ì¢…ë¥˜ë¥¼ ì„ íƒí•˜ê³  íƒ€ë¡œ ì¹´ë“œ 3ì¥ì„ ë½‘ì•„ë³´ì„¸ìš”!")

# ìš´ì„¸ ì„ íƒ
selected_fortune = st.selectbox("ğŸ“Œ ìš´ì„¸ ì¢…ë¥˜ë¥¼ ì„ íƒí•˜ì„¸ìš”", fortune_types)

if st.button("ğŸƒ íƒ€ë¡œ ì¹´ë“œ ë½‘ê¸°"):
    selected_cards = random.sample(tarot_cards, 3)

    st.subheader(f"âœ¨ {selected_fortune} ë¦¬ë”© ê²°ê³¼")

    for i, card in enumerate(selected_cards, 1):
        st.markdown(f"### {i}. {card['name']}")
        st.image(card["image"], width=200)
        st.markdown(f"**ì˜ë¯¸:** *{card['meanings'][selected_fortune]}*")
        st.markdown("---")

    # ì¢…í•© í•´ì„ ì¶œë ¥
    st.subheader("ğŸ” ì¢…í•© í•´ì„")
    st.markdown(generate_summary(selected_fortune, selected_cards))

# ì„¤ëª…
with st.expander("ğŸ“˜ íƒ€ë¡œ ë¦¬ë”©ì´ë€?"):
    st.markdown("""
    íƒ€ë¡œ ì¹´ë“œëŠ” ë‹¹ì‹ ì˜ ë¬´ì˜ì‹ê³¼ íë¦„ì„ ë°˜ì˜í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.  
    ì„ íƒí•œ ì£¼ì œ(ìš´ì„¸)ì— ë”°ë¼ ì¹´ë“œì˜ í•´ì„ì€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´ìš”.  
    ì¢…í•© í•´ì„ì€ ì„¸ ì¥ì˜ ì˜ë¯¸ë¥¼ í•˜ë‚˜ë¡œ ì—®ì–´ ì¡°ì–¸ì˜ íë¦„ì„ ì œì‹œí•©ë‹ˆë‹¤.  
    ì¬ë¯¸ì™€ ì°¸ê³ ìš©ìœ¼ë¡œ í™œìš©í•´ë³´ì„¸ìš” ğŸ™
    """)
